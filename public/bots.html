<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>
        Vulpin3 | Bots
    </title>
    <script src="https://cdn.tailwindcss.com">
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&amp;display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js">
    </script>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
        }

        .hover-effect:hover {
            background-color: #f3f4f6;
            transition: background-color 0.3s ease;
        }
    </style>
</head>

<body class="bg-gray-100 relative">
    <div id="particles-js" class="absolute inset-0 z-0">
    </div>
    <div class="min-h-screen flex flex-col relative z-10">
        <!-- Navigation -->
        <nav class="bg-white shadow-md">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex">
                        <div class="flex-shrink-0 flex items-center">
                           <!-- <img alt="Logo of the Vulpin3 Dashboard" class="h-8 w-8" height="32"
                                src="assets/Logo-black.png" width="32" />-->
                            <span class="ml-2 text-xl font-bold">
                                Vulpin3
                            </span>
                        </div>
                        <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                            <a class="border-transparent text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
                                href="/dashboard">
                                Dashboard
                            </a>
                           
                            <a class="border-indigo-500 text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
                                href="/">
                                Create
                            </a>
                            <a class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
                                href="/bconsole">
                                Console
                            </a>
                        </div>
                    </div>
                    <div class="hidden sm:ml-6 sm:flex sm:items-center">
                        <div class="relative">
                            <button aria-expanded="false" aria-haspopup="true"
                                class="max-w-xs bg-white flex items-center text-sm rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                                id="user-menu-button">
                                <img alt="Profile picture of the currently logged in user" class="h-8 w-8 rounded-full"
                                    height="32"
                                    src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTjqh2qW9yiZ56kxvX64S3kiji0QwFMjXM_tg&s"
                                    id="UserImage" width="32" />
                            </button>
                        </div>
                        <div class="ml-3 relative">
                            <div>
                                <button aria-expanded="false" aria-haspopup="true"
                                    class="bg-white rounded-full flex text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
                                    id="profile-menu-button">
                                    <span class="sr-only">
                                        Open user menu
                                    </span>
                                    <i class="ri-user-line text-xl">
                                    </i>
                                </button>
                            </div>
                            <div aria-labelledby="profile-menu-button" aria-orientation="vertical"
                                class="origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none hidden"
                                id="profile-menu" role="menu" tabindex="-1">
                                <a class="block px-4 py-2 text-sm text-gray-700 hover-effect" href="/my-profile" id="user-menu-item-0" role="menuitem" tabindex="-1">
                                    Your Profile
                                   </a>
                                  
                                   <a class="block px-4 py-2 text-sm text-gray-700 hover-effect" href="/logout" id="user-menu-item-2" role="menuitem" tabindex="-1">
                                    Sign out
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        <!-- Main Content -->
        <main class="flex-grow">
            <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
                <div class="px-4 py-6 sm:px-0">
                   
                    <div class="mt-8 space-y-4">
                        <div class="bg-white shadow-md rounded-lg p-4">
                            <h2 class="text-xl font-semibold text-gray-800">
                                Enter Kahoot PIN
                            </h2>
                            <input class="mt-2 p-2 border border-gray-300 rounded w-full" id="kahoot-pin"
                                placeholder="Enter Kahoot PIN" type="text" />
                            <button class="mt-4 bg-indigo-600 text-white px-4 py-2 rounded" id="submit-pin">
                                Submit
                            </button>
                        </div>
                        <div class="bg-white shadow-md rounded-lg p-4 hidden" id="bot-options">
                            <h2 class="text-xl font-semibold text-gray-800">
                                Bot Options
                            </h2>
                            <div class="mt-4">
                                <label class="block text-gray-700">
                                    Bot Name
                                </label>
                                <input class="mt-2 p-2 border border-gray-300 rounded w-full" id="bot-name"
                                    placeholder="Enter Bot Name" type="text" />
                            </div>
                            <div class="mt-4">
                                <label class="block text-gray-700">
                                    Bot Type
                                </label>
                                <select class="mt-2 p-2 border border-gray-300 rounded w-full" id="bot-type">
                                    <option value="single">
                                        Single Bot
                                    </option>
                                    <option value="raid">
                                        Raid
                                    </option>
                                </select>
                            </div>
                            <div class="mt-4 hidden" id="raid-options">
                                <label class="block text-gray-700">
                                    Number of Bots
                                </label>
                                <input class="mt-2 p-2 border border-gray-300 rounded w-full" id="bot-amount"
                                    placeholder="Enter Number of Bots" type="number" />
                            </div>
                            <div class="mt-4 flex items-center">
                                <label class="block text-gray-700 mr-4">
                                    Smart AI
                                </label>
                                <input class="toggle-checkbox" id="smart-ai" type="checkbox" />
                                <label class="toggle-label" for="smart-ai">
                                </label>
                            </div>
                            <button class="mt-4 bg-indigo-600 text-white px-4 py-2 rounded">
                                Create Bot
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <!-- Footer -->
        <footer class="bg-white shadow-md">
            <div class="max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-500">
                        Â© 2025 Vulpin3 Dashboard. All rights reserved.
                    </p>
                    <div class="flex space-x-4">
                        <a class="text-gray-400 hover:text-gray-500" href="#">
                            <i class="ri-facebook-circle-line text-xl">
                            </i>
                        </a>
                        <a class="text-gray-400 hover:text-gray-500" href="#">
                            <i class="ri-twitter-line text-xl">
                            </i>
                        </a>
                        <a class="text-gray-400 hover:text-gray-500" href="#">
                            <i class="ri-instagram-line text-xl">
                            </i>
                        </a>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <script>

        document.addEventListener('DOMContentLoaded', () => {
            // Fetch the logged-in user data
            fetch('/getuser')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.log('Error fetching user data:', data.error);
                        return;
                    }

                    const imgElement = document.getElementById('UserImage');
                    // If you want to show the profile picture somewhere in the form, use this:
                    const profilePicUrl = data.profile_picture;
                    if (profilePicUrl) {
                        // Add the header if it's missing (assuming it's a PNG image)
                        const formattedProfilePicUrl = profilePicUrl.startsWith('data:image') ? profilePicUrl : `data:image/png;base64,${profilePicUrl}`;
                        imgElement.src = formattedProfilePicUrl

                        // imgElement.src = formattedProfilePicUrl;
                        imgElement.alt = "Profile Picture";
                    }
                })
                .catch(error => {
                    console.error('Error during user data fetch:', error);
                });
        });

        document.addEventListener('DOMContentLoaded', () => {
            anime({
                targets: 'h1',
                translateY: [-50, 0],
                opacity: [0, 1],
                duration: 1000,
                easing: 'easeOutExpo'
            });

            const profileMenuButton = document.getElementById('profile-menu-button');
            const profileMenu = document.getElementById('profile-menu');

            profileMenuButton.addEventListener('click', () => {
                if (profileMenu.classList.contains('hidden')) {
                    profileMenu.classList.remove('hidden');
                    anime({
                        targets: '#profile-menu',
                        opacity: [0, 1],
                        translateY: [-10, 0],
                        duration: 300,
                        easing: 'easeOutExpo'
                    });
                } else {
                    anime({
                        targets: '#profile-menu',
                        opacity: [1, 0],
                        translateY: [0, -10],
                        duration: 300,
                        easing: 'easeOutExpo',
                        complete: () => {
                            profileMenu.classList.add('hidden');
                        }
                    });
                }
            });


            particlesJS.load('particles-js', 'assets/particles.json', function () {
                console.log('particles.js loaded - callback');
            });


            const submitPinButton = document.getElementById('submit-pin');
const botOptions = document.getElementById('bot-options');
const botTypeSelect = document.getElementById('bot-type');
const raidOptions = document.getElementById('raid-options');
const createBotButton = document.querySelector('#bot-options button');

submitPinButton.addEventListener('click', () => {
    const kahootPin = document.getElementById('kahoot-pin').value.trim();

    // Check if the Kahoot PIN is valid
    if (!kahootPin || isNaN(kahootPin)) {
        alert('Please enter a valid Kahoot PIN.');
        return;
    }

    botOptions.classList.remove('hidden');
    anime({
        targets: '#bot-options',
        opacity: [0, 1],
        translateY: [-10, 0],
        duration: 300,
        easing: 'easeOutExpo',
    });
});

botTypeSelect.addEventListener('change', () => {
    if (botTypeSelect.value === 'raid') {
        raidOptions.classList.remove('hidden');
        anime({
            targets: '#raid-options',
            opacity: [0, 1],
            translateY: [-10, 0],
            duration: 300,
            easing: 'easeOutExpo',
        });
    } else {
        raidOptions.classList.add('hidden');
    }
});

createBotButton.addEventListener('click', () => {
    const kahootPin = document.getElementById('kahoot-pin').value.trim();
    const botName = document.getElementById('bot-name').value.trim();
    const botType = botTypeSelect.value;
    const botAmount = document.getElementById('bot-amount').value.trim();
    const smartAI = document.getElementById('smart-ai').checked;

    // Validate fields
    if (!kahootPin || isNaN(kahootPin)) {
        alert('Please enter a valid Kahoot PIN.');
        return;
    }

    if (!botName) {
        alert('Please enter a bot name.');
        return;
    }

    if (botType === 'raid' && (!botAmount || isNaN(botAmount) || botAmount <= 0)) {
        alert('Please enter a valid number of bots for the raid.');
        return;
    }

    // Construct the request payload
    const payload = {
        bot_name: botName,
        pin: parseInt(kahootPin, 10),
        amount: botType === 'raid' ? parseInt(botAmount, 10) : 1,
        smart: smartAI,
    };

    // Make the POST request
    fetch('/createbot', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(payload),
    })
        .then((response) => {
            if (!response.ok) {
                throw new Error(`Error: ${response.status}`);
            }
            return response.json();
        })
        .then((data) => {
            alert(data.message || 'Bot(s) created successfully!');
        })
        .catch((error) => {
            console.error('Error creating bot:', error);
            alert('Failed to create bot(s). Please try again.');
        });
});

        });
    </script>
</body>

</html>